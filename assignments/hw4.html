<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Your name here">

<title>STAT151A Homework 4.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-MMK2VCM6EW"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-MMK2VCM6EW', { 'anonymize_ip': true});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">STAT151A Homework 4.</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../stat_bear.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/berkeley-stat151a/fall-2024" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course_policies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Policies</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lectures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../datasets/data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quizzes/quizzes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quizzes</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#fixed-effects-and-the-fwl-theorem" id="toc-fixed-effects-and-the-fwl-theorem" class="nav-link active" data-scroll-target="#fixed-effects-and-the-fwl-theorem"><span class="header-section-number">1</span> Fixed effects and the FWL theorem</a></li>
  <li><a href="#omitted-variables-in-inference-versus-prediction" id="toc-omitted-variables-in-inference-versus-prediction" class="nav-link" data-scroll-target="#omitted-variables-in-inference-versus-prediction"><span class="header-section-number">2</span> Omitted variables in inference versus prediction</a></li>
  <li><a href="#regression-to-the-mean-with-noisy-test-set-data" id="toc-regression-to-the-mean-with-noisy-test-set-data" class="nav-link" data-scroll-target="#regression-to-the-mean-with-noisy-test-set-data"><span class="header-section-number">3</span> Regression to the mean with noisy test set data</a></li>
  <li><a href="#simulations" id="toc-simulations" class="nav-link" data-scroll-target="#simulations"><span class="header-section-number">4</span> Simulations</a></li>
  <li><a href="#multivariate-normal-exercises" id="toc-multivariate-normal-exercises" class="nav-link" data-scroll-target="#multivariate-normal-exercises"><span class="header-section-number">5</span> Multivariate normal exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STAT151A Homework 4.</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Your name here </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>This homework is due on Gradescope on <strong>Monday October 28th at 9pm</strong>.</p>
<section id="fixed-effects-and-the-fwl-theorem" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Fixed effects and the FWL theorem</h1>
<p>Suppose we are interested in measuring the effect of class size on teaching evalutaions. Let <span class="math inline">\(y_n\)</span> denote the teaching evaluation submitted by a particular student in a particular class and let <span class="math inline">\(x_n\)</span> denote the class size for the <span class="math inline">\(n\)</span>–th teaching evaluation.</p>
<p>Suppose there are <span class="math inline">\(K\)</span> students, and that each row was submitted by exactly one of the <span class="math inline">\(K\)</span> students. Suppose also that each student submitted a teaching evaluation for each class they took, so that a particular student contributes to multiple rows. Let <span class="math inline">\(z_n\)</span> denote a one–hot indicator recording which student submitted the <span class="math inline">\(n\)</span>–th teaching evaluation. By <span class="math inline">\(k(n)\)</span>, denote the index of the student who submitted row <span class="math inline">\(n\)</span>. (For example, if student <span class="math inline">\(3\)</span> wrote the review in row <span class="math inline">\(10\)</span>, then <span class="math inline">\(k(10) = 3\)</span>.)</p>
<p>We will be interested in <span class="math inline">\(\hat{\beta}\)</span> in the regression <span class="math inline">\(y_n \sim x_n \beta + \boldsymbol{z}_n^\intercal\gamma\)</span>.</p>
<p><strong>(a)</strong></p>
<p>Let <span class="math inline">\(\underset{\boldsymbol{Z}}{\boldsymbol{P}}\)</span> denote the projection matrix onto <span class="math inline">\(\boldsymbol{Z}\)</span>, the <span class="math inline">\(N \times K\)</span> matrix of <span class="math inline">\(\boldsymbol{z}_n\)</span> regressors. Show that <span class="math display">\[
\left(\underset{\boldsymbol{Z}}{\boldsymbol{P}} \boldsymbol{Y}\right)_n = \frac{1}{N_{k(n)}} \sum_{m: k(m) = k(n)} y_m =: \bar{y}_{k(n)},
\]</span> where <span class="math inline">\(N_{k(n)}\)</span> is the number of rows in which student <span class="math inline">\(k(n)\)</span> occurs and <span class="math inline">\(\bar{y}_{k}\)</span> is the average rating submitted by student <span class="math inline">\(k\)</span>. That is, the projection onto <span class="math inline">\(\boldsymbol{Z}\)</span> computes the average evaluation submitted by each student.</p>
<p><strong>(b)</strong></p>
<p>Define <span class="math inline">\(y'_n := y_n - \bar{y}_{k(n)}\)</span> denote the students’ evaluations centered at each students’ mean evaluation, and let <span class="math inline">\(\boldsymbol{Y}' = (y'_1, \ldots, y'_N)\)</span>. Show that <span class="math inline">\(\boldsymbol{Y}' = \underset{\boldsymbol{Z}^\perp}{\boldsymbol{P}} \boldsymbol{Y}\)</span>.</p>
<p><strong>(c)</strong></p>
<p>Let <span class="math inline">\(\boldsymbol{X}= (x_1, \ldots x_N)^\intercal\)</span> denote the vector of class sizes. Let <span class="math inline">\(\bar{x}_{k}\)</span> denote the average size of class taken by student <span class="math inline">\(k(n)\)</span>. Let <span class="math inline">\(x'_n := x_n - \bar{x}_{k(n)}\)</span>. Using the FWL theorem, show that <span class="math inline">\(\hat{\beta}\)</span> in the regression <span class="math inline">\(y_n \sim x_n \beta + \boldsymbol{z}_n^\intercal\gamma\)</span> is equal to <span class="math inline">\(\hat{\beta}\)</span> in the regression <span class="math inline">\(y'_n \sim x'_n \beta\)</span>.</p>
<p><strong>(d)</strong></p>
<p>Some students tend to give higher ratings than others, and some students tend to take larger classes than others.<br>
Models like this are sometime called “fixed effects models,” since they estimate the student-to-student variability with “fixed” regression parameters. How would you interpret <span class="math inline">\(\hat{\gamma}_k\)</span>, the <span class="math inline">\(k\)</span>–th estimate coefficient in the regression <span class="math inline">\(y_n \sim x_n \beta + \boldsymbol{z}_n^\intercal\gamma\)</span>?</p>
</section>
<section id="omitted-variables-in-inference-versus-prediction" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Omitted variables in inference versus prediction</h1>
<p>Suppose we are interested in student performance as measured by fourth–year GPA, <span class="math inline">\(y_n\)</span>, centered at <span class="math inline">\(0\)</span> and scaled to have unit variance. Suppose we imagine two regressors:</p>
<ul>
<li><span class="math inline">\(x_n\)</span>: Student’s academic ability (in an abstract sense, maybe not precisely measurable or defined), and</li>
<li><span class="math inline">\(z_n\)</span>: Student’s performance on a standardized test before admission.</li>
</ul>
<p>Suppose that <span class="math inline">\(y_n = \beta x_n + \varepsilon_n\)</span>, where <span class="math inline">\(\varepsilon_n\)</span> is mean zero, independent of <span class="math inline">\(x_n\)</span>, and with variance <span class="math inline">\(\sigma_\varepsilon^2\)</span>. We will also assume that <span class="math inline">\(\beta &gt; 0\)</span>. This simplistic model is unrealistic, but we will use it for illustrative purposes, and assume for this problem that this model determines the “true” relationship between <span class="math inline">\(x_n\)</span>, <span class="math inline">\(z_n\)</span>, and <span class="math inline">\(y_n\)</span>.</p>
<p>Note that <span class="math inline">\(z_n\)</span> effectively has a zero coefficient in the “true” model — student score is causally determined entirely by “ability,” not by test score.</p>
<p>Assume that we have centered and standardized <span class="math inline">\(x_n\)</span> and <span class="math inline">\(z_n\)</span>, so that</p>
<p><span class="math display">\[
\begin{aligned}
\frac{1}{N} \sum_{n=1}^Nx_n =&amp; \frac{1}{N} \sum_{n=1}^Nz_n = 0 \quad\textrm{and} \\
\frac{1}{N} \sum_{n=1}^Nx_n^2 =&amp; \frac{1}{N} \sum_{n=1}^Nz_n^2 = 1.
\end{aligned}
\]</span> But large values of <span class="math inline">\(x_n\)</span> and <span class="math inline">\(z_n\)</span> tend to occur together, so that <span class="math inline">\(\frac{1}{N} \sum_{n=1}^Nx_n z_n = 0.9\)</span>. (You might think of <span class="math inline">\(x_n\)</span> and <span class="math inline">\(z_n\)</span> as having been drawn from a correlated random variables, even though they are not random for the purpose of this problem.)</p>
<p><strong>(a)</strong></p>
<p>Given the true model, how will we change a students’ expected GPA if we:</p>
<ul>
<li>Increase their test score <span class="math inline">\(z_n\)</span> by helping them memorize the answers to the test?</li>
<li>Improve their academic ability <span class="math inline">\(x_n\)</span> by teaching them better time management skills?</li>
</ul>
<p><strong>(b)</strong></p>
<p>If the number of observations <span class="math inline">\(N\)</span> is large, and we run the regression <span class="math inline">\(y_n \sim \gamma z_n\)</span>, what will the expected coefficient <span class="math inline">\(\mathbb{E}\left[\hat{\gamma}\right]\)</span> be? (In the expectation, only <span class="math inline">\(y_n\)</span> and <span class="math inline">\(\varepsilon_n\)</span> are random; the regressors are fixed.)</p>
<p>How does this compare to the “true” influence of <span class="math inline">\(z_n\)</span> on GPA? How does this compare with the “true” influence of <span class="math inline">\(x_n\)</span> on GPA?</p>
<p><strong>(c)</strong></p>
<p>Are we able to do effective inference using the regression <span class="math inline">\(y_n \sim \gamma z_n\)</span>? Explain why or why not in intuitive terms.</p>
<p><strong>(d)</strong></p>
<p>Let <span class="math inline">\(x_{*}\)</span>, <span class="math inline">\(z_{*}\)</span>, and <span class="math inline">\(y_{*}\)</span> denote a new observation not part of the training set. We still have <span class="math inline">\(y_* = \beta x_* + \varepsilon_*\)</span>, but assume now that <span class="math inline">\(x_*\)</span> and <span class="math inline">\(z_*\)</span> are random, independent of <span class="math inline">\(\varepsilon_*\)</span>, and the training data, and that their moments match the training set’s sample moments:</p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{E}\left[x_*\right] ={}&amp; \mathbb{E}\left[z_*\right] = 0 \\
\mathrm{Var}\left(x_*\right) ={}&amp; \mathrm{Var}\left(z_*\right) = 1 \\
\mathbb{E}\left[x_* z_*\right] ={}&amp; 0.9.
\end{aligned}
\]</span></p>
<p>Evaluate <span class="math inline">\(\mathbb{E}\left[y_*\right]\)</span> and <span class="math inline">\(\mathrm{Var}\left(y_*\right)\)</span>, where the randomness is over <span class="math inline">\(x_*\)</span>, <span class="math inline">\(z_*\)</span>, and <span class="math inline">\(\varepsilon_*\)</span>. Note that the answer will be in terms of <span class="math inline">\(\sigma_\varepsilon^2\)</span>, the variance of <span class="math inline">\(\varepsilon_*\)</span>.</p>
<p><strong>(e)</strong></p>
<p>Using the regression <span class="math inline">\(y_n \sim \gamma z_n\)</span>, form the prediction <span class="math inline">\(\hat{y}_{*} = z_{*} \hat{\gamma}\)</span>. Evaluate <span class="math inline">\(\mathbb{E}\left[\hat{y}_* \vert \boldsymbol{Y}\right]\)</span> and <span class="math inline">\(\mathrm{Var}\left(\hat{y}_*  \vert \boldsymbol{Y}\right)\)</span>. Again, the answer will be in terms of <span class="math inline">\(\sigma_\varepsilon^2\)</span>, the variance of <span class="math inline">\(\varepsilon_*\)</span>. Hint: <span class="math inline">\(\hat{\gamma}\)</span> is fixed (not random) conditional on <span class="math inline">\(\boldsymbol{Y}\)</span>.</p>
<p><strong>(f)</strong></p>
<p>Using (d) and (e), evalute the conditional correlation between the response and prediction:</p>
<p><span class="math display">\[
\textrm{Correlation}(y_*, \hat{y}_* \vert \boldsymbol{Y}) =
  \frac{\mathbb{E}\left[y_{*} \hat{y}_{*} \vert \boldsymbol{Y}\right]}
  {\sqrt{\mathrm{Var}\left(\hat{y}_{*} \vert \boldsymbol{Y}\right)} \sqrt{\mathrm{Var}\left(y_* | \boldsymbol{Y}\right)}}.
\]</span></p>
<p>Hint: <span class="math inline">\(\varepsilon_*\)</span>, <span class="math inline">\(x_*\)</span>, and <span class="math inline">\(z_*\)</span> are independent of the training data <span class="math inline">\(\boldsymbol{Y}\)</span>, so the conditioning doesn’t affect their expectations.</p>
<p><strong>(g)</strong></p>
<p>Suppose that <span class="math inline">\(\sigma_res / \beta\)</span> is not too large, so the residual standard deviation is not too large relative to the effect of academic ability on GPA. Are we then able to do effective prediction using the regression <span class="math inline">\(y_n \sim \gamma z_n\)</span>, say, to identify which students are likely to have good GPAs using only test scores? Explain why or why not in intuitive terms.</p>
</section>
<section id="regression-to-the-mean-with-noisy-test-set-data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Regression to the mean with noisy test set data</h1>
<p>Suppose we are interesting in building models of the brain. In particular, we want to know whether it is easier to model the brain watching dog videos versus the brain watching cat videos.</p>
<p>For each of <span class="math inline">\(n=1,\ldots, N\)</span> people, we show them videos of animals playing while recording signals from their brain. We then build a classifier to predict, using the same signals, whether that individuals is watching a dog or a cat. We then evaluate the model on new dog and cat videos, measuring for person a test set error <span class="math inline">\(\varepsilon_{dog,n}\)</span> for the dog videos and <span class="math inline">\(\varepsilon_{cat,n}\)</span> for the cat videos.</p>
<p>Since the test set is random, it is reasonable to model the errors as random and unbiased. For each <span class="math inline">\(n\)</span>, we thus have</p>
<p><span class="math display">\[
\mathbb{E}\left[\varepsilon_{dog,n}\right] = \mu_{dog,n}
\quad\quad\textrm{and}\quad\quad
\mathbb{E}\left[\varepsilon_{cat,n}\right] = \mu_{cat,n},
\]</span></p>
<p>where <span class="math inline">\(\mathrm{Var}\left(\varepsilon_{cat,n}\right) &gt; 0\)</span> and <span class="math inline">\(\mathrm{Var}\left(\varepsilon_{dog,n}\right) &gt; 0\)</span></p>
<p><strong>(a)</strong></p>
<p>Intuitively, what would it mean if <span class="math inline">\(\mu_{dog,n} = \mu_{cat,n}\)</span> for each <span class="math inline">\(n\)</span>?</p>
<p><strong>(b)</strong></p>
<p>Suppose that <span class="math inline">\(\mu_{dog,n} = \mu_{cat,n} = \mu_n\)</span> for each <span class="math inline">\(n\)</span>, and we run the regression <span class="math inline">\(\varepsilon_{dog,n} \sim  \beta\varepsilon_{cat,n}\)</span>. For very large <span class="math inline">\(N\)</span>, do you expect <span class="math inline">\(\hat{\beta}\)</span> to be larger or smaller than <span class="math inline">\(1\)</span>? Justify your answer.</p>
<p><strong>(c)</strong></p>
<p>Again, suppose that <span class="math inline">\(\mu_{dog,n} = \mu_{cat,n} = \mu_n\)</span> for each <span class="math inline">\(n\)</span>, and we run the regression <span class="math inline">\(\varepsilon_{cat,n} \sim \gamma \varepsilon_{dog,n}\)</span>. For very large <span class="math inline">\(N\)</span>, do you expect <span class="math inline">\(\hat{\gamma}\)</span> to be larger or smaller than <span class="math inline">\(1\)</span>? Justify your answer.</p>
<p><strong>(d)</strong></p>
<p>Suppose the researcher runs the regression <span class="math inline">\(\varepsilon_{dog,n} \sim \beta \varepsilon_{cat,n}\)</span> and gets <span class="math inline">\(\hat{\beta}= 0.3\)</span>. They then conclude that:</p>
<ul>
<li><span class="math inline">\(\hat{\beta}\)</span> is much less than one</li>
<li>Therefore dog errors are lower than cat errors,</li>
<li>Therefore dogs are easier to predict than cats.</li>
</ul>
<p>Is this a resonable conclusion? Why or why not?</p>
</section>
<section id="simulations" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Simulations</h1>
<p>For this problem, we will simulate data from a linear regression and confirm some of our mathematical results.</p>
<p>Define the following quantities and their corresponding R variables:</p>
<ul>
<li><span class="math inline">\(N\)</span>: The number of observations</li>
<li><span class="math inline">\(\sigma\)</span>: The residual standard deviation</li>
<li><span class="math inline">\(\boldsymbol{\beta}\)</span>: A <span class="math inline">\(3\)</span>–dimensional regression coefficient</li>
<li><span class="math inline">\(\rho\)</span>: The covariance between the regressors <span class="math inline">\(x_{n1}\)</span> and <span class="math inline">\(x_{n2}\)</span></li>
</ul>
<p>We will assume that:</p>
<ul>
<li><span class="math inline">\(x_{n1}\)</span> is normal with mean <span class="math inline">\(1\)</span> and variance <span class="math inline">\(1\)</span>,</li>
<li><span class="math inline">\(x_{n2}\)</span> is normal with mean <span class="math inline">\(2\)</span> and variance <span class="math inline">\(1\)</span>,</li>
<li><span class="math inline">\(\mathrm{Cov}\left(x_{n2}, x_{n2}\right) = \rho\)</span> (so that <span class="math inline">\(x_{n1}\)</span> is not independent of <span class="math inline">\(x_{n2}\)</span> if <span class="math inline">\(\rho \ne 0\)</span>),</li>
<li>The regressor rows are independent of one another (<span class="math inline">\(x_{n1}\)</span> and <span class="math inline">\(x_{n2}\)</span> are independent of <span class="math inline">\(x_{m1}\)</span> and <span class="math inline">\(x_{m2}\)</span> for <span class="math inline">\(m \ne n\)</span>),</li>
<li>The residuals <span class="math inline">\(\varepsilon_n\)</span> are IID normal with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\sigma^2\)</span>, indepenent of all regressors, and</li>
<li>For each <span class="math inline">\(n\)</span>, <span class="math inline">\(y_n = \boldsymbol{x}_n^\intercal\boldsymbol{\beta}+ \varepsilon_n\)</span>.</li>
</ul>
<p><strong>(a)</strong></p>
<p>Write a function to generate a regressors <span class="math inline">\(\boldsymbol{x}_1\)</span>, <span class="math inline">\(\boldsymbol{x}_2\)</span>, and <span class="math inline">\(\boldsymbol{Y}\)</span> given the inputs <span class="math inline">\(N\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(\boldsymbol{\beta}\)</span>, and <span class="math inline">\(\rho\)</span>. You may use the functions <code>rnorm</code> (which generates standard normal random variables) and <code>rmvnorm</code> from the <code>mvtnorm</code> package which draws multivariate normal random variables.</p>
<p>Check that <span class="math inline">\(\boldsymbol{x}_1\)</span> and <span class="math inline">\(\boldsymbol{x}_2\)</span> have the correct covariance using <code>cov</code>.</p>
<p><strong>(b)</strong></p>
<p>Write a function to compute <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> for the regression <span class="math inline">\(\boldsymbol{Y}\sim \boldsymbol{X}\boldsymbol{\beta}\)</span> given <span class="math inline">\(\boldsymbol{X}\)</span> and <span class="math inline">\(\boldsymbol{Y}\)</span> as inputs.</p>
<p>Donot use the <code>lm</code> function — use only matrix operations <code>solve()</code>, <code>t()</code>, and <code>%*%</code>. Your function may assume that <span class="math inline">\(\boldsymbol{X}\)</span> is full column rank. However, please do check that your answer is the same as that given by <code>lm</code>.</p>
<p><strong>(c)</strong></p>
<p>Using (a) and (b), run the regression <span class="math inline">\(y_n \sim 1 + x_{n1} + x_{n2}\)</span> for the following inputs:</p>
<ul>
<li><span class="math inline">\(N = 5000\)</span></li>
<li><span class="math inline">\(\sigma = 3\)</span></li>
<li><span class="math inline">\(\boldsymbol{\beta}= (1, 2, 3)^\intercal\)</span></li>
<li><span class="math inline">\(\rho = 0.8\)</span></li>
</ul>
<p>How does <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> compare to the true value <span class="math inline">\(\boldsymbol{\beta}\)</span>? Justify your observation mathematically.</p>
<p><strong>(d)</strong></p>
<p>Repeat (c), but with the regression <span class="math inline">\(y_n \sim 1 + x_{n1}\)</span>. How do the estimated coefficients compare with the true intercept and coefficient for <span class="math inline">\(x_{n1}\)</span>? Justify your observation mathematically.</p>
<p><strong>(e)</strong></p>
<p>Repeat (c), but with the regression <span class="math inline">\(y_n \sim 1 + x_{n1}\)</span> and with <span class="math inline">\(\rho = 0\)</span>. How do the estimated coefficients compare with the true intercept and coefficient for <span class="math inline">\(x_{n1}\)</span>? Justify your observation mathematically.</p>
<p><strong>(f)</strong></p>
<p>Using the simulated data to illustrate a theoretical result of your choice from the class.</p>
</section>
<section id="multivariate-normal-exercises" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Multivariate normal exercises</h1>
<p>Let <span class="math inline">\(\boldsymbol{x}\sim \mathcal{N}\left(\boldsymbol{\mu}, \boldsymbol{\Sigma}\right)\)</span> where</p>
<p><span class="math display">\[
\boldsymbol{\mu}=
\begin{pmatrix}
1 \\ 2 \\ 3
\end{pmatrix}
\quad\textrm{and}\quad
\boldsymbol{\Sigma}=
\begin{pmatrix}
1 &amp;   0.5 &amp; 0 \\
0.5 &amp; 2   &amp; 0.1 \\
0   &amp; 0.1   &amp; 4 \\
\end{pmatrix}.
\]</span></p>
<p>Let</p>
<p><span class="math display">\[
\boldsymbol{v}=
\begin{pmatrix}
0 \\ 1 \\ 0
\end{pmatrix}
\quad
\boldsymbol{a}=
\begin{pmatrix}
2 \\ 1 \\ 1
\end{pmatrix}
\quad
\boldsymbol{A}=
\begin{pmatrix}
1 &amp; 1 &amp; 0 \\
2 &amp; 0 &amp; 1 \\
\end{pmatrix}
\]</span></p>
<p>Evaluate the following expressions.</p>
<ol type="1">
<li><span class="math inline">\(\mathbb{E}\left[\boldsymbol{v}^\intercal\boldsymbol{x}\right]\)</span></li>
<li><span class="math inline">\(\mathrm{Var}\left(\boldsymbol{v}^\intercal\boldsymbol{x}\right)\)</span></li>
<li><span class="math inline">\(\mathbb{E}\left[\boldsymbol{a}^\intercal\boldsymbol{x}\right]\)</span></li>
<li><span class="math inline">\(\mathrm{Var}\left(\boldsymbol{a}^\intercal\boldsymbol{x}\right)\)</span></li>
<li><span class="math inline">\(\mathbb{E}\left[\boldsymbol{v}\boldsymbol{x}^\intercal\right]\)</span></li>
<li><span class="math inline">\(\mathbb{E}\left[\boldsymbol{x}\boldsymbol{x}^\intercal\right]\)</span></li>
<li><span class="math inline">\(\mathbb{E}\left[\boldsymbol{x}^\intercal\boldsymbol{x}\right]\)</span></li>
<li><span class="math inline">\(\mathbb{E}\left[\mathrm{trace}\left(\boldsymbol{x}\boldsymbol{x}^\intercal\right)\right]\)</span></li>
<li><span class="math inline">\(\mathbb{E}\left[\boldsymbol{A}\boldsymbol{x}\right]\)</span></li>
<li><span class="math inline">\(\mathrm{Cov}\left(\boldsymbol{A}\boldsymbol{x}\right)\)</span></li>
<li><span class="math inline">\(\mathbb{E}\left[(\boldsymbol{A}\boldsymbol{x}) (\boldsymbol{A}\boldsymbol{x})^\intercal\right]\)</span></li>
<li><span class="math inline">\(\mathbb{E}\left[(\boldsymbol{A}\boldsymbol{x})^\intercal(\boldsymbol{A}\boldsymbol{x})\right]\)</span></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>